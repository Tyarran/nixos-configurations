# AGENTS.md - NixOS Configuration Guidelines

## Build/Lint/Test Commands

### Build Commands
- `nixos-rebuild build`: Build the NixOS configuration without applying it
- `nixos-rebuild switch`: Build and apply the configuration to the system
- `nixos-rebuild test`: Test the configuration in a temporary environment

### Lint Commands
- `nixfmt .`: Format all Nix files in the repository
- `statix check .`: Run static analysis on Nix files for potential issues
- `deadnix .`: Find unused code in Nix expressions

### Test Commands
- `nixos-rebuild build --flake .#hostname`: Build specific host configuration (replace hostname)
- `nixos-rebuild dry-run`: Show what would be built without actually building

## Code Style Guidelines

### Nix Language Conventions
- Use `nixfmt` for consistent formatting (2-space indentation, trailing commas)
- Import modules using relative paths: `./hardware-configuration.nix`
- Use descriptive attribute names (snake_case preferred)
- Group related configuration sections together
- Comment complex configurations explaining why, not what

### File Organization
- Keep hardware-configuration.nix generated by `nixos-generate-config`
- Separate user configurations into dedicated .nix files (e.g., users.nix)
- Use imports array for modular configuration
- One configuration per host directory

### Security
- Never commit plaintext passwords or secrets
- Use hashed passwords for user accounts
- Restrict firewall rules to necessary ports only
- Enable security features (SSH, fail2ban if used)

### Error Handling
- Test configurations with `nixos-rebuild test` before switching
- Use `nixos-rebuild build` to catch build errors early
- Review generated hardware-configuration.nix after hardware changes</content>
<parameter name="filePath">/home/romain/Projects/nixos-configurations/AGENTS.md